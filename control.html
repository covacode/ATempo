<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ATempo | Control</title>
    <link rel="stylesheet" href="fontawesome/css/all.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js';
        import { getDatabase, ref, set, push, remove } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js';

        // Configuración de Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCWWsVzpfPYQmjNa5kW_5_7FmwM9wjQX3Q",
            authDomain: "atempo-sacb.firebaseapp.com",
            projectId: "atempo-sacb",
            storageBucket: "atempo-sacb.appspot.com",
            messagingSenderId: "954859089085",
            appId: "1:954859089085:web:f79f743bbd836eed7d1bd4",
            databaseURL: "https://atempo-sacb-default-rtdb.firebaseio.com/"
        };

        // Inicializar Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        document.addEventListener('DOMContentLoaded', () => {
            // Referencias a los nodos en la base de datos
            const timerRef = ref(database, 'timer');
            const messagesRef = ref(database, 'messages');

            // Configurar temporizador
            document.getElementById('set-timer-btn').addEventListener('click', () => {
                let timerValor = document.getElementById('timer').value;
                const timerValue = parseInt(timerValor);
                set(timerRef, timerValue)
                    .then(() => alert('Temporizador establecido a ' + timerValue + ' minutos'))
                    .catch(error => console.error('Error al establecer temporizador:', error));
            });

            // Enviar mensaje
            document.getElementById('send-message-btn').addEventListener('click', () => {
                const message = document.getElementById('message').value;
                push(messagesRef, message)
                    .then(() => alert('Mensaje enviado: ' + message))
                    .catch(error => console.error('Error al enviar mensaje:', error));
            });

            // Reiniciar datos
            document.getElementById('reset-btn').addEventListener('click', () => {
                remove(timerRef)
                    .then(() => remove(messagesRef))
                    .then(() => alert('Cronómetro y mensaje reiniciados.'))
                    .catch(error => console.error('Error al reiniciar datos:', error));
            });
        });
    </script>
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center"><i class="far fa-clock"></i> ATempo</h1>
        <div class="mb-5">
            <strong for="timer" class="form-label">Temporizador en minutos</strong>
            <input type="number" class="form-control" id="timer" placeholder="Ingrese los minutos">
            <button id="set-timer-btn" class="btn btn-success mt-2">Enviar</button>
        </div>
        <div class="mb-3">
            <strong for="message" class="form-label">Mensaje</strong>
            <textarea class="form-control" id="message" rows="3" placeholder="Escriba su mensaje"></textarea>
            <button id="send-message-btn" class="btn btn-success mt-2">Enviar</button>
        </div>
        <div class="text-center">
            <button id="reset-btn" class="btn btn-danger mt-4">Reiniciar</button>
        </div>
    </div>
</body>
</html>
